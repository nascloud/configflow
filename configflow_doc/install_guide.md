# Config Flow 安装与入门指南

## 开始之前
- 确认机器上已安装 Docker（Windows、macOS、Linux 均适用）。
- 预留一个可访问的端口，例如 `80`，便于浏览器访问。
- 建议准备一个空文件夹，用来保存 Config Flow 的数据备份。

---

## 快速部署
> 目标：把服务跑起来，确保能打开页面。

在准备好的文件夹中执行以下命令：
```bash
docker run -d \
  --name config-flow \
  -p 80:80 \
  -v $(pwd)/data:/data \
  -e ADMIN_USERNAME=admin \
  -e ADMIN_PASSWORD=admin123 \
  -e JWT_SECRET_KEY=your-secret-key-please-change-in-production \
  thsrite/config-flow:latest
```

命令执行完成后：
- 访问 `http://localhost`，出现登录页说明部署成功。
- `-v $(pwd)/data:/data` 会把数据保存到当前目录的 `data` 文件夹，方便以后迁移或备份。

> 请把 `ADMIN_PASSWORD` 和 `JWT_SECRET_KEY` 替换为更安全的值，生产环境务必更新凭据。

---

## 首次配置流程
> 目标：导入资源、设置策略、生成第一份配置。

1. **导入资源**
   - 「订阅管理」：添加机场订阅链接。
   - 「节点管理」：适合逐条录入或批量导入单个节点。
2. **整理策略**
   - 在「策略管理」按用途建立策略组，例如“办公直连”“全局代理”。
   - 需要分流的规则，可提前在「规则仓库」整理常用规则集。
3. **生成配置**
   - 进入「规则配置」，把规则与策略组关联。
   - 前往「配置生成」，选择目标格式（Mihomo / MosDNS），确认后导出并导入到客户端。

完成以上三步，就能在客户端看到新的连接策略。

> 提示：服务内置了一套基础配置，首次登录后只需导入订阅即可使用，后续可在策略和规则中逐步优化。

---

## 功能速览
- **订阅管理**：统一管理多个订阅源，支持拖拽排序和格式转换。
- **节点管理**：支持常见协议，批量导入、启停。
- **策略管理**：URL-Test、Fallback、Load-Balance 等策略，支持从订阅、节点中选择，支持跟随其他策略组（复用其他策略组的策略）。
- **规则仓库与规则配置**：集中维护规则集，并按顺序控制流量去向。
- **配置生成**：即时预览配置内容，可导出 JSON 备份，方便分享。

---

## 常见问题
**Q：没有 Docker 经验怎么办？** 安装 Docker Desktop 或 Docker Engine 后，直接复制上面的命令即可运行。

**Q：想让其他人访问该服务？** 启动命令中的 `-p 80:80` 可调整为服务器对外端口，例如 `-p 8080:80`，再开放防火墙即可。

**Q：换电脑或重装系统会丢配置吗？** 不会，`data` 文件夹已经挂载在本地，复制该文件夹即可恢复。

**Q：如何升级？** 执行 `docker stop config-flow && docker rm config-flow`，再拉取最新版镜像后按同样命令重新运行，旧数据会自动加载。

---

现在就启动 Config Flow，完成部署与首份配置，后续即可根据业务需要继续拓展规则和策略。
